{"version":3,"sources":["../../src/zip-writer.js"],"names":["ZipWriter","name","extensions","category","mimeType","encode","encodeZipAsync","fileMap","options","jsZip","JSZip","subFileName","subFileData","file","Object","assign","type","onUpdate","generateAsync","error","log"],"mappings":";;;;;;;;;AAAA;;AAEO,IAAMA,SAAS,GAAG;AACvBC,EAAAA,IAAI,EAAE,aADiB;AAEvBC,EAAAA,UAAU,EAAE,CAAC,KAAD,CAFW;AAGvBC,EAAAA,QAAQ,EAAE,SAHa;AAIvBC,EAAAA,QAAQ,EAAE,iBAJa;AAKvBC,EAAAA,MAAM,EAAEC;AALe,CAAlB;;;AAQP,SAASA,cAAT,CAAwBC,OAAxB,EAAiCC,OAAjC,EAA0C;AACxC,MAAMC,KAAK,GAAG,IAAIC,iBAAJ,EAAd;;AAEA,OAAK,IAAMC,WAAX,IAA0BJ,OAA1B,EAAmC;AACjC,QAAMK,WAAW,GAAGL,OAAO,CAACI,WAAD,CAA3B;AAIAF,IAAAA,KAAK,CAACI,IAAN,CAAWF,WAAX,EAAwBC,WAAxB,EAAqCJ,OAArC;AACD;;AAGDA,EAAAA,OAAO,GAAGM,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBP,OAAlB,EAA2B;AACnCQ,IAAAA,IAAI,EAAE;AAD6B,GAA3B,CAAV;AAZwC,iBAeVR,OAfU;AAAA,mCAejCS,QAfiC;AAAA,MAejCA,QAfiC,kCAetB,YAAM,CAAE,CAfc;AAiBxC,SAAOR,KAAK,CAACS,aAAN,CAAoBV,OAApB,EAA6BS,QAA7B,WAA6C,UAAAE,KAAK,EAAI;AAC3DX,IAAAA,OAAO,CAACY,GAAR,CAAYD,KAAZ,wCAAkDA,KAAlD;AACA,UAAMA,KAAN;AACD,GAHM,CAAP;AAID","sourcesContent":["import JSZip from 'jszip';\n\nexport const ZipWriter = {\n  name: 'Zip Archive',\n  extensions: ['zip'],\n  category: 'archive',\n  mimeType: 'application/zip',\n  encode: encodeZipAsync\n};\n\nfunction encodeZipAsync(fileMap, options) {\n  const jsZip = new JSZip();\n  // add files to the zip\n  for (const subFileName in fileMap) {\n    const subFileData = fileMap[subFileName];\n\n    // jszip supports both arraybuffer and string data (the main loaders.gl types)\n    // https://stuk.github.io/jszip/documentation/api_zipobject/async.html\n    jsZip.file(subFileName, subFileData, options);\n  }\n\n  // always generate the full zip as an arraybuffer\n  options = Object.assign({}, options, {\n    type: 'arraybuffer'\n  });\n  const {onUpdate = () => {}} = options;\n\n  return jsZip.generateAsync(options, onUpdate).catch(error => {\n    options.log.error(`Unable to write zip archive: ${error}`);\n    throw error;\n  });\n}\n"],"file":"zip-writer.js"}