{"version":3,"sources":["../../src/zip-writer.js"],"names":["JSZip","ZipWriter","name","extensions","category","mimeType","encode","encodeZipAsync","fileMap","options","jsZip","subFileName","subFileData","file","Object","assign","type","onUpdate","generateAsync","error","log"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAO,IAAMC,SAAS,GAAG;AACvBC,EAAAA,IAAI,EAAE,aADiB;AAEvBC,EAAAA,UAAU,EAAE,CAAC,KAAD,CAFW;AAGvBC,EAAAA,QAAQ,EAAE,SAHa;AAIvBC,EAAAA,QAAQ,EAAE,iBAJa;AAKvBC,EAAAA,MAAM,EAAEC;AALe,CAAlB;;AAQP,SAASA,cAAT,CAAwBC,OAAxB,EAAiCC,OAAjC,EAA0C;AACxC,MAAMC,KAAK,GAAG,IAAIV,KAAJ,EAAd;;AAEA,OAAK,IAAMW,WAAX,IAA0BH,OAA1B,EAAmC;AACjC,QAAMI,WAAW,GAAGJ,OAAO,CAACG,WAAD,CAA3B;AAIAD,IAAAA,KAAK,CAACG,IAAN,CAAWF,WAAX,EAAwBC,WAAxB,EAAqCH,OAArC;AACD;;AAGDA,EAAAA,OAAO,GAAGK,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBN,OAAlB,EAA2B;AACnCO,IAAAA,IAAI,EAAE;AAD6B,GAA3B,CAAV;AAZwC,iBAeVP,OAfU;AAAA,mCAejCQ,QAfiC;AAAA,MAejCA,QAfiC,kCAetB,YAAM,CAAE,CAfc;AAiBxC,SAAOP,KAAK,CAACQ,aAAN,CAAoBT,OAApB,EAA6BQ,QAA7B,WAA6C,UAAAE,KAAK,EAAI;AAC3DV,IAAAA,OAAO,CAACW,GAAR,CAAYD,KAAZ,wCAAkDA,KAAlD;AACA,UAAMA,KAAN;AACD,GAHM,CAAP;AAID","sourcesContent":["import JSZip from 'jszip';\n\nexport const ZipWriter = {\n  name: 'Zip Archive',\n  extensions: ['zip'],\n  category: 'archive',\n  mimeType: 'application/zip',\n  encode: encodeZipAsync\n};\n\nfunction encodeZipAsync(fileMap, options) {\n  const jsZip = new JSZip();\n  // add files to the zip\n  for (const subFileName in fileMap) {\n    const subFileData = fileMap[subFileName];\n\n    // jszip supports both arraybuffer and string data (the main loaders.gl types)\n    // https://stuk.github.io/jszip/documentation/api_zipobject/async.html\n    jsZip.file(subFileName, subFileData, options);\n  }\n\n  // always generate the full zip as an arraybuffer\n  options = Object.assign({}, options, {\n    type: 'arraybuffer'\n  });\n  const {onUpdate = () => {}} = options;\n\n  return jsZip.generateAsync(options, onUpdate).catch(error => {\n    options.log.error(`Unable to write zip archive: ${error}`);\n    throw error;\n  });\n}\n"],"file":"zip-writer.js"}